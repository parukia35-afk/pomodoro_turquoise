import{o as P,n as j,g as q,a as F,b as A,w as R,s as L,r as I,c as E,t as x,u as S,_ as W,d as H,e as G,f as k,h as l,i as d,j as K,k as B,l as w,m as v,F as _,p as J,q as Q,V as C,v as X}from"./index-cE4stkiT.js";import{u as Y}from"./list-Bd9yAyN0.js";import{u as Z}from"./settings-BCSOBfCb.js";import{V as ee,a as V,b as te}from"./VDivider-D65-kpqy.js";function $(e,t){return q()?(F(e,t),!0):!1}function y(){const e=new Set,t=n=>{e.delete(n)};return{on:n=>{e.add(n);const o=()=>t(n);return $(o),{off:o}},off:t,trigger:(...n)=>Promise.all(Array.from(e).map(o=>o(...n))),clear:()=>{e.clear()}}}const ne=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ie=Object.prototype.toString,oe=e=>ie.call(e)==="[object Object]";function M(e){return Array.isArray(e)?e:[e]}function se(e){return A()}function re(e,t=!0,r){se()?P(e,r):t?e():j(e)}function ae(e,t,r){return R(e,t,{...r,immediate:!0})}const z=ne?window:void 0;function le(e){var t;const r=x(e);return(t=r?.$el)!==null&&t!==void 0?t:r}function ce(...e){const t=(i,s,n,o)=>(i.addEventListener(s,n,o),()=>i.removeEventListener(s,n,o)),r=E(()=>{const i=M(x(e[0])).filter(s=>s!=null);return i.every(s=>typeof s!="string")?i:void 0});return ae(()=>{var i,s;return[(i=(s=r.value)===null||s===void 0?void 0:s.map(n=>le(n)))!==null&&i!==void 0?i:[z].filter(n=>n!=null),M(x(r.value?e[1]:e[0])),M(S(r.value?e[2]:e[1])),x(r.value?e[3]:e[2])]},([i,s,n,o],f,p)=>{if(!i?.length||!s?.length||!n?.length)return;const g=oe(o)?{...o}:o,h=i.flatMap(a=>s.flatMap(c=>n.map(m=>t(a,c,m,g))));p(()=>{h.forEach(a=>a())})},{flush:"post"})}function ue(){const e=L(!1),t=A();return t&&P(()=>{e.value=!0},t),e}function de(e){const t=ue();return E(()=>(t.value,!!e()))}function fe(e={}){const{window:t=z,requestPermissions:r=!0}=e,i=e,s=de(()=>{if(!t||!("Notification"in t))return!1;if(Notification.permission==="granted")return!0;try{const u=new Notification("");u.onshow=()=>{u.close()}}catch(u){if(u.name==="TypeError")return!1}return!0}),n=L(s.value&&"permission"in Notification&&Notification.permission==="granted"),o=I(null),f=async()=>{if(s.value)return!n.value&&Notification.permission!=="denied"&&await Notification.requestPermission()==="granted"&&(n.value=!0),n.value},{on:p,trigger:g}=y(),{on:h,trigger:a}=y(),{on:c,trigger:m}=y(),{on:T,trigger:D}=y(),U=async u=>{if(!s.value||!n.value)return;const b=Object.assign({},i,u);return o.value=new Notification(b.title||"",b),o.value.onclick=g,o.value.onshow=a,o.value.onerror=m,o.value.onclose=D,o.value},N=()=>{o.value&&o.value.close(),o.value=null};if(r&&re(f),$(N),s.value&&t){const u=t.document;ce(u,"visibilitychange",b=>{b.preventDefault(),u.visibilityState==="visible"&&N()})}return{isSupported:s,notification:o,ensurePermissions:f,permissionGranted:n,show:U,close:N,onClick:p,onShow:h,onError:c,onClose:T}}const me={height:"523.213px",version:"1.1",viewBox:"0 0 289 523.213",width:"289px",x:"0px","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",y:"0px"},ve={__name:"DigitNumber",props:["data","color"],setup(e){return H(t=>({v08188ba2:e.color})),(t,r)=>(k(),G("svg",me,[l("path",{id:"B",class:d({active:"045689".includes(e.data)}),d:"M20,249.873c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V249.873z"},null,2),l("path",{id:"C",class:d({active:"01234789".includes(e.data)}),d:"M289,249.873c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V249.873z"},null,2),l("path",{id:"A",class:d({active:"02356789".includes(e.data)}),d:"M255.082,1.873c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914L36.918,20c-5.522-0.048-9.961-4.563-9.914-10.086l0,0C27.052,4.392,31.567-0.047,37.09,0L255.082,1.873z"},null,2),l("path",{id:"D",class:d({active:"2345689".includes(e.data)}),d:"M255.082,250.81c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914l-217.992-1.873c-5.522-0.048-9.961-4.563-9.914-10.086l0,0c0.047-5.522,4.563-9.961,10.085-9.914L255.082,250.81z"},null,2),l("path",{id:"G",class:d({active:"0235689".includes(e.data)}),d:"M255.082,503.213c5.522,0.048,9.961,4.563,9.914,10.086l0,0c-0.048,5.522-4.563,9.961-10.086,9.914L36.918,521.34c-5.522-0.048-9.961-4.563-9.914-10.086l0,0c0.047-5.522,4.563-9.961,10.085-9.914L255.082,503.213z"},null,2),l("path",{id:"E",class:d({active:"0268".includes(e.data)}),d:"M20,498.818c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V498.818z"},null,2),l("path",{id:"F",class:d({active:"013456789".includes(e.data)}),d:"M289,498.818c0,5.523-4.477,10-10,10l0,0c-5.523,0-10-4.477-10-10v-218c0-5.523,4.477-10,10-10l0,0c5.523,0,10,4.477,10,10V498.818z"},null,2),l("circle",{class:d({active:e.data===":"}),cx:"146",cy:"126.873",r:"17"},null,2),l("circle",{class:d({active:e.data===":"}),cx:"146",cy:"389.818",r:"17"},null,2)]))}},pe=W(ve,[["__scopeId","data-v-c9041c0b"]]),O="1500",ge="300",he=K("time",()=>{const e=I(O),t=I(!1);return{timeleft:e,isBreakTime:t,TIME:O,TIME_BREAK:ge}}),ye={__name:"HomeView",setup(e){const t=Y(),r=Z(),i=he(),s=E(()=>{const a=Math.floor(i.timeleft/60).toString().padStart(2,"0"),c=(i.timeleft%60).toString().padStart(2,"0");return a+":"+c}),n={STOP:0,COUNTING:1,PAUSE:2},o=I(n.STOP);let f=0;const p=()=>{o.value===n.STOP&&t.items.length>0&&t.currentItem===""&&(t.currentItem=i.isBreakTime?"休息":t.items.shift().text),o.value=n.COUNTING,f=setInterval(()=>{i.timeleft--,i.timeleft<0&&g()},1e3)},g=()=>{clearInterval(f),o.value=n.STOP;const a=new Audio;a.src=r.selectedAlarm.file,a.play();const{show:c,isSupported:m,permissionGranted:T}=fe({title:"事項完成",body:t.currentItem,icon:new URL("/assets/pomodoro-technique-MdbnESj4.png",import.meta.url).href});m.value&&T.value&&c(),i.isBreakTime||t.finishedItems.push({id:t.id++,text:t.currentItem}),t.currentItem="",t.items.length>0&&(i.isBreakTime=!i.isBreakTime),i.timeleft=i.isBreakTime?i.TIME_BREAK:i.TIME,t.items.length>0&&p()},h=()=>{clearInterval(f),o.value=n.PAUSE};return(a,c)=>(k(),B(X,null,{default:w(()=>[v(ee,null,{default:w(()=>[v(V,{cols:"12"},{default:w(()=>[...c[0]||(c[0]=[l("h1",{class:"text-center"},"目前事項",-1)])]),_:1}),v(te),v(V,{class:"text-center",cols:"12"},{default:w(()=>[(k(!0),G(_,null,J(s.value,(m,T)=>(k(),B(pe,{key:T,color:"turquoise",data:m},null,8,["data"]))),128)),l("h2",null,Q(S(t).currentItem||"沒有事項"),1),v(C,{disabled:o.value===n.COUNTING||S(t).currentItem.length===0&&S(t).items.length===0,icon:"mdi-play",onClick:p},null,8,["disabled"]),v(C,{disabled:o.value!==n.COUNTING,icon:"mdi-pause",onClick:h},null,8,["disabled"]),v(C,{disabled:S(t).currentItem.length===0,icon:"mdi-skip-next",onClick:g},null,8,["disabled"])]),_:1})]),_:1})]),_:1}))}};export{ye as default};
